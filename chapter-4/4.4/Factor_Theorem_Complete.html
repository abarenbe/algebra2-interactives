<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Factor Theorem | 4.4 Factoring Polynomials</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .site-nav {
            background: rgba(0,0,0,0.2);
            padding: 12px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 20px;
            background: rgba(255,255,255,0.15);
            transition: all 0.3s ease;
            font-size: 0.95em;
        }

        .nav-link:hover { background: rgba(255,255,255,0.25); }
        .nav-title { color: white; font-weight: 600; font-size: 1em; }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
        }

        header h1 {
            font-size: 2em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p { font-size: 1.1em; opacity: 0.9; }

        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .tab-btn:hover { background: rgba(255,255,255,0.3); }
        .tab-btn.active { background: white; color: #667eea; font-weight: bold; }

        .section {
            display: none;
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .section.active { display: block; }

        h2 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-top: 0;
        }

        h3 { color: #764ba2; margin-top: 25px; }

        .info-box {
            background: linear-gradient(135deg, #e8f4fd 0%, #e0e7ff 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #667eea;
        }

        .why-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #f59e0b;
        }

        .formula-box {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border: 2px solid #ffc107;
            font-size: 1.2em;
            text-align: center;
        }

        .example-card {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .example-card h4 {
            color: #667eea;
            margin: 0 0 15px 0;
        }

        .polynomial-display {
            font-size: 1.4em;
            text-align: center;
            padding: 15px;
            background: white;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px solid #667eea;
            font-family: 'Times New Roman', serif;
        }

        .step-navigator {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
        }

        .step-nav-btn {
            padding: 10px 20px;
            border: none;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .step-nav-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102,126,234,0.4);
        }

        .step-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .step-indicator {
            font-weight: 600;
            color: #667eea;
        }

        .step-dots {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin: 10px 0;
        }

        .step-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
            transition: all 0.3s ease;
        }

        .step-dot.active { background: #667eea; transform: scale(1.2); }
        .step-dot.completed { background: #28a745; }

        .watch-step {
            background: #f0f4ff;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            min-height: 150px;
        }

        .watch-step-title {
            font-weight: 600;
            color: #667eea;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        .watch-work {
            background: white;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            line-height: 2;
        }

        .highlight { background: #fff3cd; padding: 2px 6px; border-radius: 4px; }
        .highlight-green { background: #d4edda; padding: 2px 6px; border-radius: 4px; }
        .highlight-red { background: #f8d7da; padding: 2px 6px; border-radius: 4px; }

        .problem-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .step-container {
            background: #f0f4ff;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .step-number {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
        }

        .step-number.completed { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); }

        .step-title {
            font-weight: 600;
            color: #333;
            font-size: 1.05em;
        }

        .step-content { margin-left: 47px; }

        .step-completed-text {
            color: #28a745;
            font-weight: 500;
            margin-left: 47px;
            padding: 8px 12px;
            background: #d4edda;
            border-radius: 6px;
            display: inline-block;
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 10px 0;
            flex-wrap: wrap;
        }

        input[type="text"] {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1.1em;
            flex: 1;
            min-width: 150px;
        }

        input[type="text"]:focus {
            border-color: #667eea;
            outline: none;
        }

        input[type="text"].correct {
            border-color: #28a745;
            background: #d4edda;
        }

        input[type="text"].incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .radio-group {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .radio-option {
            padding: 12px 24px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1em;
        }

        .radio-option:hover { border-color: #667eea; background: #f0f0ff; }
        .radio-option.selected { border-color: #667eea; background: #e0e7ff; }
        .radio-option.correct { border-color: #28a745; background: #d4edda; }
        .radio-option.incorrect { border-color: #dc3545; background: #f8d7da; }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-success { background: #28a745; color: white; }
        .btn-success:hover { background: #218838; }

        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }

        .feedback.show { display: block; }
        .feedback.correct { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .feedback.incorrect { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }

        .score-display {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            margin: 15px 0;
            font-size: 1.2em;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255,255,255,0.3);
            border-radius: 4px;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: white;
            border-radius: 4px;
            transition: width 0.5s ease;
        }

        .hidden { display: none !important; }

        .scratch-workspace {
            background: #fffbeb;
            border: 2px dashed #f59e0b;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .scratch-workspace h4 {
            margin: 0 0 15px 0;
            color: #92400e;
        }

        .synth-div-grid {
            display: grid;
            gap: 5px;
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            margin: 15px 0;
            overflow-x: auto;
        }

        .synth-row {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .synth-cell {
            width: 50px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            background: white;
        }

        .synth-cell.k-value {
            background: #e0e7ff;
            font-weight: bold;
        }

        .synth-cell.divider {
            border-bottom: 3px solid #667eea;
        }

        .synth-input {
            width: 50px;
            height: 40px;
            text-align: center;
            border: 1px dashed #aaa;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 1em;
            background: rgba(255,255,255,0.9);
        }

        .synth-input:focus {
            border-color: #667eea;
            border-style: solid;
            outline: none;
        }

        .difficulty-selector {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin: 15px 0;
        }

        .diff-btn {
            padding: 8px 20px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .diff-btn:hover { border-color: #667eea; }
        .diff-btn.active { background: #667eea; color: white; border-color: #667eea; }

        .final-answer-section {
            background: #e0e7ff;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .final-answer-section h4 {
            margin: 0 0 15px 0;
            color: #4338ca;
        }

        .graph-container {
            margin: 20px 0;
            border-radius: 10px;
            overflow: hidden;
        }

        .binomial-highlight {
            font-weight: bold;
            color: #667eea;
            font-size: 1.1em;
        }

        .connection-box {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #10b981;
        }

        @media (max-width: 768px) {
            header h1 { font-size: 1.6em; }
            .tab-btn { padding: 10px 16px; font-size: 0.9em; }
            .polynomial-display { font-size: 1.2em; }
            .step-content { margin-left: 0; margin-top: 10px; }
            .step-completed-text { margin-left: 0; }
            .synth-cell, .synth-input { width: 40px; height: 35px; font-size: 0.9em; }
        }
    </style>
</head>
<body>
    <nav class="site-nav">
        <a href="./" class="nav-link">&larr; 4.4 Factoring</a>
        <span class="nav-title">Factor Theorem</span>
    </nav>

    <div class="container">
        <header>
            <h1>The Factor Theorem</h1>
            <p>Connect factors, zeros, and polynomial evaluation</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="showSection('learn')">Learn</button>
            <button class="tab-btn" onclick="showSection('watch')">See</button>
            <button class="tab-btn" onclick="showSection('practice')">Practice</button>
            <button class="tab-btn" onclick="showSection('solo')">Do</button>
        </div>

        <!-- LEARN SECTION -->
        <div id="learn" class="section active">
            <h2>Understanding the Factor Theorem</h2>

            <div class="formula-box">
                <strong>The Factor Theorem:</strong><br><br>
                (x - k) is a factor of f(x) <strong>if and only if</strong> f(k) = 0
            </div>

            <div class="why-box">
                <h3 style="margin-top:0;">Why Does This Work?</h3>
                <p>The Factor Theorem connects three big ideas:</p>
                <ol>
                    <li><strong>Factors:</strong> If (x - k) is a factor, then f(x) = (x - k) · q(x) for some polynomial q(x)</li>
                    <li><strong>Zeros:</strong> When we substitute x = k: f(k) = (k - k) · q(k) = 0 · q(k) = 0</li>
                    <li><strong>Division:</strong> If f(k) = 0, then dividing f(x) by (x - k) leaves no remainder</li>
                </ol>
                <p>So finding where f(k) = 0 tells us (x - k) divides evenly into f(x)!</p>
            </div>

            <div class="connection-box">
                <h3 style="margin-top:0;">The Big Connection</h3>
                <p>These three statements are all saying the same thing:</p>
                <ul>
                    <li><strong>k is a zero of f(x)</strong> - the function equals zero at x = k</li>
                    <li><strong>(x - k) is a factor of f(x)</strong> - it divides evenly with no remainder</li>
                    <li><strong>The graph of f(x) crosses the x-axis at x = k</strong> - it's an x-intercept</li>
                </ul>
            </div>

            <h3>How to Use the Factor Theorem</h3>
            <div class="example-card">
                <h4>To test if (x - k) is a factor:</h4>
                <ol>
                    <li><strong>Identify k</strong> from the binomial (x - k). Remember: if you have (x + 2), then k = -2!</li>
                    <li><strong>Evaluate f(k)</strong> by substituting k into the polynomial</li>
                    <li><strong>Check the result:</strong>
                        <ul>
                            <li>If f(k) = 0, then YES, (x - k) is a factor</li>
                            <li>If f(k) ≠ 0, then NO, (x - k) is not a factor</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="example-card">
                <h4>Example: Is (x - 2) a factor of f(x) = x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6?</h4>
                <div style="font-family:'Courier New', monospace; line-height:2; padding:15px; background:white; border-radius:8px;">
                    <div>Test k = 2:</div>
                    <div>f(2) = (2)³ - 6(2)² + 11(2) - 6</div>
                    <div>f(2) = 8 - 24 + 22 - 6</div>
                    <div>f(2) = <span class="highlight-green">0</span></div>
                    <div><br><strong>Since f(2) = 0, (x - 2) IS a factor!</strong></div>
                </div>
            </div>

            <div class="info-box">
                <h3 style="margin-top:0;">Using Synthetic Division</h3>
                <p>You can also use <strong>synthetic division</strong> to test if (x - k) is a factor:</p>
                <ul>
                    <li>If the remainder is 0, then (x - k) is a factor</li>
                    <li>The quotient gives you the other factor</li>
                </ul>
                <p>This is often faster than substituting, especially for higher-degree polynomials!</p>
            </div>

            <h3>Finding Zeros from Factors</h3>
            <div class="example-card">
                <h4>If you know f(x) = (x - 1)(x - 2)(x - 3):</h4>
                <p>The zeros are x = 1, x = 2, and x = 3</p>
                <p>The graph crosses the x-axis at these three points.</p>
            </div>
        </div>

        <!-- WATCH SECTION -->
        <div id="watch" class="section">
            <h2>See</h2>

            <div class="difficulty-selector">
                <button class="diff-btn active" onclick="selectWatchExample(0)">Example 1</button>
                <button class="diff-btn" onclick="selectWatchExample(1)">Example 2</button>
                <button class="diff-btn" onclick="selectWatchExample(2)">Example 3</button>
            </div>

            <div class="polynomial-display" id="watch-problem">Is (x - 2) a factor of x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6?</div>

            <div class="step-dots" id="watch-dots"></div>

            <div class="watch-step" id="watch-step-content">
                <div class="watch-step-title" id="watch-step-title">Step 1</div>
                <div class="watch-work" id="watch-work"></div>
            </div>

            <div class="step-navigator">
                <button class="step-nav-btn" id="watch-prev" onclick="watchPrev()">← Previous</button>
                <span class="step-indicator" id="watch-indicator">Step 1 of 4</span>
                <button class="step-nav-btn" id="watch-next" onclick="watchNext()">Next →</button>
            </div>

            <div class="graph-container" id="watch-graph"></div>
        </div>

        <!-- PRACTICE SECTION -->
        <div id="practice" class="section">
            <h2>Practice</h2>
            <p>Use the Factor Theorem to determine if a binomial is a factor.</p>

            <div class="score-display">
                Score: <span id="practice-score">0</span> / <span id="practice-total">0</span>
                <div class="progress-bar"><div class="progress-fill" id="practice-progress" style="width:0%"></div></div>
            </div>

            <div class="problem-card">
                <h3>Is <span id="practice-binomial" class="binomial-highlight"></span> a factor of:</h3>
                <div class="polynomial-display" id="practice-problem"></div>

                <!-- Step 1: Identify k -->
                <div class="step-container" id="practice-step1">
                    <div class="step-header">
                        <div class="step-number" id="practice-step1-num">1</div>
                        <div class="step-title">What value of k should you test? (from the binomial x - k)</div>
                    </div>
                    <div class="step-content" id="practice-step1-content">
                        <div class="input-group">
                            <span>k = </span>
                            <input type="text" id="practice-step1-answer" placeholder="e.g., 2 or -3" style="max-width:100px;">
                            <button class="btn btn-primary" onclick="checkPracticeStep1()">Check</button>
                        </div>
                    </div>
                    <div class="step-completed-text hidden" id="practice-step1-complete"></div>
                </div>

                <!-- Step 2: Evaluate f(k) -->
                <div class="step-container hidden" id="practice-step2">
                    <div class="step-header">
                        <div class="step-number" id="practice-step2-num">2</div>
                        <div class="step-title">Calculate f(<span id="practice-k-display"></span>)</div>
                    </div>
                    <div class="step-content" id="practice-step2-content">
                        <div class="input-group">
                            <span>f(<span id="practice-k-display2"></span>) = </span>
                            <input type="text" id="practice-step2-answer" placeholder="e.g., 0" style="max-width:100px;">
                            <button class="btn btn-primary" onclick="checkPracticeStep2()">Check</button>
                        </div>
                    </div>
                    <div class="step-completed-text hidden" id="practice-step2-complete"></div>
                </div>

                <!-- Step 3: Conclusion -->
                <div class="step-container hidden" id="practice-step3">
                    <div class="step-header">
                        <div class="step-number" id="practice-step3-num">3</div>
                        <div class="step-title">Is the binomial a factor?</div>
                    </div>
                    <div class="step-content" id="practice-step3-content">
                        <div class="radio-group">
                            <div class="radio-option" onclick="selectConclusion(true)">Yes, it's a factor</div>
                            <div class="radio-option" onclick="selectConclusion(false)">No, it's not a factor</div>
                        </div>
                    </div>
                    <div class="step-completed-text hidden" id="practice-step3-complete"></div>
                </div>

                <div class="feedback" id="practice-feedback"></div>
                <button class="btn btn-success" onclick="newPracticeProblem()" style="margin-top:15px;">New Problem</button>
            </div>

            <div class="graph-container" id="practice-graph"></div>
        </div>

        <!-- SOLO SECTION -->
        <div id="solo" class="section">
            <h2>Do</h2>
            <p>Work through problems independently using synthetic division.</p>

            <div class="difficulty-selector">
                <button class="diff-btn active" onclick="setSoloDifficulty('easy')">Easy</button>
                <button class="diff-btn" onclick="setSoloDifficulty('medium')">Medium</button>
                <button class="diff-btn" onclick="setSoloDifficulty('hard')">Hard</button>
            </div>

            <div class="score-display">
                Score: <span id="solo-score">0</span> / <span id="solo-total">0</span>
                <div class="progress-bar"><div class="progress-fill" id="solo-progress" style="width:0%"></div></div>
            </div>

            <div class="problem-card">
                <h3>Is <span id="solo-binomial" class="binomial-highlight"></span> a factor of:</h3>
                <div class="polynomial-display" id="solo-problem"></div>

                <div class="scratch-workspace">
                    <h4>Scratch Workspace - Synthetic Division</h4>
                    <p style="margin-bottom:15px; color:#78716c;">Use synthetic division to find the remainder. If remainder = 0, it's a factor!</p>
                    <div id="solo-synth-grid"></div>
                </div>

                <div class="final-answer-section">
                    <h4>Is the binomial a factor?</h4>
                    <div class="radio-group" style="margin-bottom:15px;">
                        <div class="radio-option" id="solo-yes" onclick="selectSoloAnswer(true)">Yes, it's a factor</div>
                        <div class="radio-option" id="solo-no" onclick="selectSoloAnswer(false)">No, it's not a factor</div>
                    </div>
                    <button class="btn btn-primary" onclick="checkSoloAnswer()">Submit Answer</button>
                </div>

                <div class="feedback" id="solo-feedback"></div>
                <button class="btn btn-success" onclick="newSoloProblem()" style="margin-top:15px;">New Problem</button>
            </div>

            <div class="graph-container" id="solo-graph"></div>
        </div>
    </div>

    <script>
        // Tab navigation
        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList.add('active');

            if (id === 'watch') initWatch();
            if (id === 'practice' && !currentPractice) newPracticeProblem();
            if (id === 'solo' && !currentSolo) newSoloProblem();
        }

        // =====================
        // WATCH SECTION
        // =====================
        const watchExamples = [
            {
                question: "Is (x - 2) a factor of x³ - 6x² + 11x - 6?",
                questionHTML: "Is (x - 2) a factor of x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6?",
                poly: "x³ - 6x² + 11x - 6",
                coeffs: [1, -6, 11, -6],
                k: 2,
                isFactor: true,
                steps: [
                    { title: "Step 1: Identify k", content: "From the binomial (x - 2), we have:<br><br>k = <span class='highlight'>2</span><br><br>We need to test if f(2) = 0" },
                    { title: "Step 2: Set up the calculation", content: "f(x) = x³ - 6x² + 11x - 6<br><br>f(2) = (2)³ - 6(2)² + 11(2) - 6" },
                    { title: "Step 3: Calculate", content: "f(2) = (2)³ - 6(2)² + 11(2) - 6<br>f(2) = 8 - 6(4) + 22 - 6<br>f(2) = 8 - 24 + 22 - 6<br>f(2) = <span class='highlight'>0</span>" },
                    { title: "Step 4: Conclusion", content: "Since f(2) = <span class='highlight-green'>0</span>:<br><br><strong>(x - 2) IS a factor of x³ - 6x² + 11x - 6</strong><br><br>This means x = 2 is a zero, and the graph crosses the x-axis at x = 2" }
                ]
            },
            {
                question: "Is (x + 1) a factor of x³ + 2x² - 5x - 6?",
                questionHTML: "Is (x + 1) a factor of x<sup>3</sup> + 2x<sup>2</sup> - 5x - 6?",
                poly: "x³ + 2x² - 5x - 6",
                coeffs: [1, 2, -5, -6],
                k: -1,
                isFactor: true,
                steps: [
                    { title: "Step 1: Identify k", content: "From (x + 1), rewrite as (x - (-1)):<br><br>k = <span class='highlight'>-1</span><br><br>Remember: (x + 1) means k is negative!" },
                    { title: "Step 2: Set up the calculation", content: "f(x) = x³ + 2x² - 5x - 6<br><br>f(-1) = (-1)³ + 2(-1)² - 5(-1) - 6" },
                    { title: "Step 3: Calculate", content: "f(-1) = (-1)³ + 2(-1)² - 5(-1) - 6<br>f(-1) = -1 + 2(1) + 5 - 6<br>f(-1) = -1 + 2 + 5 - 6<br>f(-1) = <span class='highlight'>0</span>" },
                    { title: "Step 4: Conclusion", content: "Since f(-1) = <span class='highlight-green'>0</span>:<br><br><strong>(x + 1) IS a factor of x³ + 2x² - 5x - 6</strong><br><br>The graph crosses the x-axis at x = -1" }
                ]
            },
            {
                question: "Is (x - 4) a factor of x³ - 6x² + 11x - 6?",
                questionHTML: "Is (x - 4) a factor of x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6?",
                poly: "x³ - 6x² + 11x - 6",
                coeffs: [1, -6, 11, -6],
                k: 4,
                isFactor: false,
                steps: [
                    { title: "Step 1: Identify k", content: "From the binomial (x - 4):<br><br>k = <span class='highlight'>4</span>" },
                    { title: "Step 2: Set up the calculation", content: "f(x) = x³ - 6x² + 11x - 6<br><br>f(4) = (4)³ - 6(4)² + 11(4) - 6" },
                    { title: "Step 3: Calculate", content: "f(4) = (4)³ - 6(4)² + 11(4) - 6<br>f(4) = 64 - 6(16) + 44 - 6<br>f(4) = 64 - 96 + 44 - 6<br>f(4) = <span class='highlight-red'>6</span> (not zero!)" },
                    { title: "Step 4: Conclusion", content: "Since f(4) = <span class='highlight-red'>6 ≠ 0</span>:<br><br><strong>(x - 4) is NOT a factor of x³ - 6x² + 11x - 6</strong><br><br>The graph does NOT cross the x-axis at x = 4" }
                ]
            }
        ];

        let currentWatchExample = 0;
        let currentWatchStep = 0;

        function initWatch() {
            selectWatchExample(0);
        }

        function selectWatchExample(idx) {
            currentWatchExample = idx;
            currentWatchStep = 0;

            document.querySelectorAll('#watch .diff-btn').forEach((b, i) => {
                b.classList.toggle('active', i === idx);
            });

            const example = watchExamples[idx];
            document.getElementById('watch-problem').innerHTML = example.questionHTML;

            const dotsContainer = document.getElementById('watch-dots');
            dotsContainer.innerHTML = example.steps.map((_, i) =>
                `<div class="step-dot${i === 0 ? ' active' : ''}"></div>`
            ).join('');

            updateWatchStep();
            drawGraph('watch-graph', example.coeffs, example.k);
        }

        function updateWatchStep() {
            const example = watchExamples[currentWatchExample];
            const step = example.steps[currentWatchStep];

            document.getElementById('watch-step-title').textContent = step.title;
            document.getElementById('watch-work').innerHTML = step.content;
            document.getElementById('watch-indicator').textContent = `Step ${currentWatchStep + 1} of ${example.steps.length}`;

            document.querySelectorAll('#watch .step-dot').forEach((dot, i) => {
                dot.classList.remove('active', 'completed');
                if (i < currentWatchStep) dot.classList.add('completed');
                if (i === currentWatchStep) dot.classList.add('active');
            });

            document.getElementById('watch-prev').disabled = currentWatchStep === 0;
            document.getElementById('watch-next').disabled = currentWatchStep === example.steps.length - 1;
        }

        function watchPrev() {
            if (currentWatchStep > 0) {
                currentWatchStep--;
                updateWatchStep();
            }
        }

        function watchNext() {
            const example = watchExamples[currentWatchExample];
            if (currentWatchStep < example.steps.length - 1) {
                currentWatchStep++;
                updateWatchStep();
            }
        }

        // =====================
        // PRACTICE SECTION
        // =====================
        const practiceProblems = [
            { poly: "x³ - 6x² + 11x - 6", polyHTML: "f(x) = x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6", coeffs: [1, -6, 11, -6], k: 2, binomial: "(x - 2)", isFactor: true },
            { poly: "x³ - 6x² + 11x - 6", polyHTML: "f(x) = x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6", coeffs: [1, -6, 11, -6], k: 1, binomial: "(x - 1)", isFactor: true },
            { poly: "x³ - 6x² + 11x - 6", polyHTML: "f(x) = x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6", coeffs: [1, -6, 11, -6], k: 3, binomial: "(x - 3)", isFactor: true },
            { poly: "x³ - 6x² + 11x - 6", polyHTML: "f(x) = x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6", coeffs: [1, -6, 11, -6], k: 4, binomial: "(x - 4)", isFactor: false },
            { poly: "x³ + 2x² - 5x - 6", polyHTML: "f(x) = x<sup>3</sup> + 2x<sup>2</sup> - 5x - 6", coeffs: [1, 2, -5, -6], k: 2, binomial: "(x - 2)", isFactor: true },
            { poly: "x³ + 2x² - 5x - 6", polyHTML: "f(x) = x<sup>3</sup> + 2x<sup>2</sup> - 5x - 6", coeffs: [1, 2, -5, -6], k: -1, binomial: "(x + 1)", isFactor: true },
            { poly: "x³ + 2x² - 5x - 6", polyHTML: "f(x) = x<sup>3</sup> + 2x<sup>2</sup> - 5x - 6", coeffs: [1, 2, -5, -6], k: 4, binomial: "(x - 4)", isFactor: false }
        ];

        let currentPractice = null;
        let practiceScore = 0;
        let practiceTotal = 0;

        function newPracticeProblem() {
            currentPractice = practiceProblems[Math.floor(Math.random() * practiceProblems.length)];

            document.getElementById('practice-problem').innerHTML = currentPractice.polyHTML;
            document.getElementById('practice-binomial').textContent = currentPractice.binomial;

            // Reset all steps
            for (let i = 1; i <= 3; i++) {
                document.getElementById(`practice-step${i}`).classList.remove('hidden');
                document.getElementById(`practice-step${i}-num`).classList.remove('completed');
                document.getElementById(`practice-step${i}-content`).classList.remove('hidden');
                document.getElementById(`practice-step${i}-complete`).classList.add('hidden');
            }

            document.getElementById('practice-step1-answer').value = '';
            document.getElementById('practice-step1-answer').classList.remove('correct', 'incorrect');
            document.getElementById('practice-step2-answer').value = '';
            document.getElementById('practice-step2-answer').classList.remove('correct', 'incorrect');

            document.getElementById('practice-step2').classList.add('hidden');
            document.getElementById('practice-step3').classList.add('hidden');

            document.querySelectorAll('#practice-step3 .radio-option').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
            });

            document.getElementById('practice-feedback').className = 'feedback';
            document.getElementById('practice-feedback').style.display = 'none';

            drawGraph('practice-graph', currentPractice.coeffs, currentPractice.k);
        }

        function checkPracticeStep1() {
            const input = document.getElementById('practice-step1-answer');
            const userK = parseFloat(input.value.trim());
            const isCorrect = userK === currentPractice.k;

            if (isCorrect) {
                input.classList.add('correct');
                document.getElementById('practice-step1-num').classList.add('completed');
                document.getElementById('practice-step1-content').classList.add('hidden');
                document.getElementById('practice-step1-complete').textContent = `k = ${currentPractice.k}`;
                document.getElementById('practice-step1-complete').classList.remove('hidden');

                document.getElementById('practice-step2').classList.remove('hidden');
                document.getElementById('practice-k-display').textContent = currentPractice.k;
                document.getElementById('practice-k-display2').textContent = currentPractice.k;
            } else {
                input.classList.add('incorrect');
                setTimeout(() => input.classList.remove('incorrect'), 500);
            }
        }

        function checkPracticeStep2() {
            const input = document.getElementById('practice-step2-answer');
            const userResult = parseFloat(input.value.trim());
            const correctResult = evaluatePoly(currentPractice.coeffs, currentPractice.k);
            const isCorrect = userResult === correctResult;

            if (isCorrect) {
                input.classList.add('correct');
                document.getElementById('practice-step2-num').classList.add('completed');
                document.getElementById('practice-step2-content').classList.add('hidden');
                document.getElementById('practice-step2-complete').textContent = `f(${currentPractice.k}) = ${correctResult}`;
                document.getElementById('practice-step2-complete').classList.remove('hidden');

                document.getElementById('practice-step3').classList.remove('hidden');
            } else {
                input.classList.add('incorrect');
                setTimeout(() => input.classList.remove('incorrect'), 500);
            }
        }

        function selectConclusion(userSaysYes) {
            const options = document.querySelectorAll('#practice-step3 .radio-option');
            options.forEach(opt => opt.classList.remove('selected'));

            const selectedOpt = userSaysYes ? options[0] : options[1];
            selectedOpt.classList.add('selected');

            const isCorrect = userSaysYes === currentPractice.isFactor;

            practiceTotal++;
            const feedback = document.getElementById('practice-feedback');

            if (isCorrect) {
                practiceScore++;
                selectedOpt.classList.add('correct');
                document.getElementById('practice-step3-num').classList.add('completed');
                document.getElementById('practice-step3-content').classList.add('hidden');
                const resultText = currentPractice.isFactor ? 'Yes, it IS a factor!' : 'No, it is NOT a factor';
                document.getElementById('practice-step3-complete').textContent = resultText;
                document.getElementById('practice-step3-complete').classList.remove('hidden');

                feedback.innerHTML = '<strong>Correct!</strong> You used the Factor Theorem perfectly!';
                feedback.className = 'feedback correct show';
            } else {
                selectedOpt.classList.add('incorrect');
                const correctText = currentPractice.isFactor ?
                    'Since f(k) = 0, the binomial IS a factor.' :
                    'Since f(k) ≠ 0, the binomial is NOT a factor.';
                feedback.innerHTML = `<strong>Not quite.</strong> ${correctText}`;
                feedback.className = 'feedback incorrect show';
            }

            document.getElementById('practice-score').textContent = practiceScore;
            document.getElementById('practice-total').textContent = practiceTotal;
            document.getElementById('practice-progress').style.width = `${(practiceScore/Math.max(practiceTotal,1))*100}%`;
        }

        // =====================
        // SOLO SECTION
        // =====================
        const soloProblems = {
            easy: [
                { poly: "x³ - 6x² + 11x - 6", polyHTML: "f(x) = x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6", coeffs: [1, -6, 11, -6], k: 2, binomial: "(x - 2)", isFactor: true },
                { poly: "x³ - 6x² + 11x - 6", polyHTML: "f(x) = x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6", coeffs: [1, -6, 11, -6], k: 1, binomial: "(x - 1)", isFactor: true },
                { poly: "x³ + 2x² - 5x - 6", polyHTML: "f(x) = x<sup>3</sup> + 2x<sup>2</sup> - 5x - 6", coeffs: [1, 2, -5, -6], k: 2, binomial: "(x - 2)", isFactor: true },
                { poly: "x³ - 4x² + x + 6", polyHTML: "f(x) = x<sup>3</sup> - 4x<sup>2</sup> + x + 6", coeffs: [1, -4, 1, 6], k: 3, binomial: "(x - 3)", isFactor: true }
            ],
            medium: [
                { poly: "x³ + 2x² - 5x - 6", polyHTML: "f(x) = x<sup>3</sup> + 2x<sup>2</sup> - 5x - 6", coeffs: [1, 2, -5, -6], k: -1, binomial: "(x + 1)", isFactor: true },
                { poly: "x³ - 6x² + 11x - 6", polyHTML: "f(x) = x<sup>3</sup> - 6x<sup>2</sup> + 11x - 6", coeffs: [1, -6, 11, -6], k: 4, binomial: "(x - 4)", isFactor: false },
                { poly: "2x³ - 3x² - 11x + 6", polyHTML: "f(x) = 2x<sup>3</sup> - 3x<sup>2</sup> - 11x + 6", coeffs: [2, -3, -11, 6], k: 3, binomial: "(x - 3)", isFactor: true },
                { poly: "x³ + 4x² + x - 6", polyHTML: "f(x) = x<sup>3</sup> + 4x<sup>2</sup> + x - 6", coeffs: [1, 4, 1, -6], k: -2, binomial: "(x + 2)", isFactor: true }
            ],
            hard: [
                { poly: "2x³ - 3x² - 11x + 6", polyHTML: "f(x) = 2x<sup>3</sup> - 3x<sup>2</sup> - 11x + 6", coeffs: [2, -3, -11, 6], k: 2, binomial: "(x - 2)", isFactor: false },
                { poly: "x⁴ - 5x³ + 5x² + 5x - 6", polyHTML: "f(x) = x<sup>4</sup> - 5x<sup>3</sup> + 5x<sup>2</sup> + 5x - 6", coeffs: [1, -5, 5, 5, -6], k: 1, binomial: "(x - 1)", isFactor: true },
                { poly: "x⁴ - 5x³ + 5x² + 5x - 6", polyHTML: "f(x) = x<sup>4</sup> - 5x<sup>3</sup> + 5x<sup>2</sup> + 5x - 6", coeffs: [1, -5, 5, 5, -6], k: -1, binomial: "(x + 1)", isFactor: true },
                { poly: "3x³ - 7x² - 8x + 4", polyHTML: "f(x) = 3x<sup>3</sup> - 7x<sup>2</sup> - 8x + 4", coeffs: [3, -7, -8, 4], k: -1, binomial: "(x + 1)", isFactor: false }
            ]
        };

        let soloDifficulty = 'easy';
        let currentSolo = null;
        let soloScore = 0;
        let soloTotal = 0;
        let soloAnswer = null;

        function setSoloDifficulty(diff) {
            soloDifficulty = diff;
            document.querySelectorAll('#solo .diff-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            newSoloProblem();
        }

        function newSoloProblem() {
            const problems = soloProblems[soloDifficulty];
            currentSolo = problems[Math.floor(Math.random() * problems.length)];
            soloAnswer = null;

            document.getElementById('solo-problem').innerHTML = currentSolo.polyHTML;
            document.getElementById('solo-binomial').textContent = currentSolo.binomial;

            // Build synthetic division grid
            buildSoloSynthGrid(currentSolo.coeffs, currentSolo.k);

            // Reset answer selection
            document.getElementById('solo-yes').classList.remove('selected', 'correct', 'incorrect');
            document.getElementById('solo-no').classList.remove('selected', 'correct', 'incorrect');

            document.getElementById('solo-feedback').className = 'feedback';
            document.getElementById('solo-feedback').style.display = 'none';

            drawGraph('solo-graph', currentSolo.coeffs, currentSolo.k);
        }

        function buildSoloSynthGrid(coeffs, k) {
            const n = coeffs.length;
            let html = '<div class="synth-div-grid">';

            // Row 1: k value and coefficients
            html += '<div class="synth-row">';
            html += `<div class="synth-cell k-value">${k}</div>`;
            html += '<div class="synth-cell" style="border:none;">|</div>';
            for (let i = 0; i < n; i++) {
                html += `<div class="synth-cell divider">${coeffs[i]}</div>`;
            }
            html += '</div>';

            // Row 2: carry values (editable, first is empty)
            html += '<div class="synth-row">';
            html += '<div class="synth-cell" style="border:none;"></div>';
            html += '<div class="synth-cell" style="border:none;">|</div>';
            html += '<div class="synth-cell" style="border:none;"></div>'; // empty under first coeff
            for (let i = 1; i < n; i++) {
                html += `<input type="text" class="synth-input" id="solo-carry-${i}">`;
            }
            html += '</div>';

            // Row 3: results (editable)
            html += '<div class="synth-row" style="border-top:2px solid #667eea; padding-top:5px;">';
            html += '<div class="synth-cell" style="border:none;"></div>';
            html += '<div class="synth-cell" style="border:none;">|</div>';
            for (let i = 0; i < n; i++) {
                html += `<input type="text" class="synth-input" id="solo-result-${i}" placeholder="${i === n-1 ? 'R' : ''}">`;
            }
            html += '</div>';

            html += '</div>';
            document.getElementById('solo-synth-grid').innerHTML = html;
        }

        function selectSoloAnswer(answer) {
            soloAnswer = answer;
            document.getElementById('solo-yes').classList.remove('selected');
            document.getElementById('solo-no').classList.remove('selected');
            if (answer) {
                document.getElementById('solo-yes').classList.add('selected');
            } else {
                document.getElementById('solo-no').classList.add('selected');
            }
        }

        function checkSoloAnswer() {
            if (soloAnswer === null) {
                alert('Please select Yes or No');
                return;
            }

            const isCorrect = soloAnswer === currentSolo.isFactor;
            soloTotal++;
            const feedback = document.getElementById('solo-feedback');

            const selectedEl = soloAnswer ? document.getElementById('solo-yes') : document.getElementById('solo-no');

            if (isCorrect) {
                soloScore++;
                selectedEl.classList.add('correct');
                const remainder = evaluatePoly(currentSolo.coeffs, currentSolo.k);
                feedback.innerHTML = `<strong>Correct!</strong> f(${currentSolo.k}) = ${remainder}${currentSolo.isFactor ? ' = 0, so it IS a factor!' : ' ≠ 0, so it is NOT a factor.'}`;
                feedback.className = 'feedback correct show';
            } else {
                selectedEl.classList.add('incorrect');
                const remainder = evaluatePoly(currentSolo.coeffs, currentSolo.k);
                const correctText = currentSolo.isFactor ?
                    `f(${currentSolo.k}) = 0, so the binomial IS a factor.` :
                    `f(${currentSolo.k}) = ${remainder} ≠ 0, so the binomial is NOT a factor.`;
                feedback.innerHTML = `<strong>Not quite.</strong> ${correctText}`;
                feedback.className = 'feedback incorrect show';
            }

            document.getElementById('solo-score').textContent = soloScore;
            document.getElementById('solo-total').textContent = soloTotal;
            document.getElementById('solo-progress').style.width = `${(soloScore/Math.max(soloTotal,1))*100}%`;
        }

        // =====================
        // UTILITY FUNCTIONS
        // =====================
        function evaluatePoly(coeffs, k) {
            let result = 0;
            for (let i = 0; i < coeffs.length; i++) {
                result = result * k + coeffs[i];
            }
            return result;
        }

        function drawGraph(containerId, coeffs, k) {
            const xVals = [], yVals = [];
            const degree = coeffs.length - 1;

            // Determine x range based on polynomial
            let minX = -5, maxX = 7;

            for (let x = minX; x <= maxX; x += 0.1) {
                xVals.push(x);
                let y = 0;
                for (let i = 0; i < coeffs.length; i++) {
                    y += coeffs[i] * Math.pow(x, coeffs.length - 1 - i);
                }
                yVals.push(y);
            }

            const fk = evaluatePoly(coeffs, k);

            Plotly.newPlot(containerId, [
                {
                    x: xVals,
                    y: yVals,
                    type: 'scatter',
                    mode: 'lines',
                    line: {color: '#667eea', width: 3},
                    name: 'f(x)'
                },
                {
                    x: [k],
                    y: [fk],
                    type: 'scatter',
                    mode: 'markers',
                    marker: {
                        color: fk === 0 ? '#28a745' : '#dc3545',
                        size: 14,
                        symbol: 'circle'
                    },
                    name: `f(${k}) = ${fk}`
                }
            ], {
                title: `Graph of f(x)`,
                xaxis: {
                    title: 'x',
                    zeroline: true,
                    zerolinecolor: '#999',
                    zerolinewidth: 2,
                    range: [minX, maxX]
                },
                yaxis: {
                    title: 'f(x)',
                    zeroline: true,
                    zerolinecolor: '#999',
                    zerolinewidth: 2
                },
                margin: {t: 50, b: 50, l: 50, r: 30},
                showlegend: true,
                legend: {x: 0.02, y: 0.98}
            }, {responsive: true});
        }

        // Enter key support
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                const target = e.target;
                if (target.id === 'practice-step1-answer') checkPracticeStep1();
                else if (target.id === 'practice-step2-answer') checkPracticeStep2();
            }
        });
    </script>
</body>
</html>
