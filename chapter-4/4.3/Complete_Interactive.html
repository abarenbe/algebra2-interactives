<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4.3 Dividing Polynomials - Interactive</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: white;
            color: #667eea;
            font-weight: bold;
        }

        .section {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            animation: fadeIn 0.5s ease;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #667eea;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-top: 0;
        }

        h3 {
            color: #764ba2;
            margin-top: 25px;
        }

        .info-box {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .warning-box {
            background: #fff3e0;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #ff9800;
        }

        .score-display {
            text-align: center;
            font-size: 1.3em;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
            margin: 20px 0;
        }

        .progress-bar {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.3);
            border-radius: 5px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: white;
            transition: width 0.5s ease;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-hint {
            background: #fff3e0;
            color: #e65100;
        }

        .practice-problem {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .division-display {
            font-size: 1.3em;
            text-align: center;
            padding: 20px;
            background: white;
            border-radius: 8px;
            margin: 15px 0;
            border: 2px solid #667eea;
            font-family: 'Cambria Math', 'Times New Roman', serif;
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 15px 0;
            flex-wrap: wrap;
        }

        .input-group label {
            font-weight: bold;
            min-width: 100px;
        }

        input[type="text"], input[type="number"] {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            font-family: 'Cambria Math', 'Times New Roman', serif;
            flex: 1;
            min-width: 200px;
        }

        input:focus {
            border-color: #667eea;
            outline: none;
        }

        input.correct {
            border-color: #28a745;
            background: #d4edda;
        }

        input.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .feedback {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }

        .feedback.show {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        .feedback.correct {
            background: #d4edda;
            color: #155724;
        }

        .feedback.incorrect {
            background: #f8d7da;
            color: #721c24;
        }

        .feedback.hint {
            background: #fff3e0;
            color: #e65100;
        }

        /* Long Division Styles */
        .long-division {
            font-family: 'Courier New', monospace;
            font-size: 1.1em;
            line-height: 1.6;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            overflow-x: auto;
        }

        .division-step {
            margin: 10px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #667eea;
        }

        .division-step.highlight {
            background: #e8f4fd;
            border-left-color: #2196f3;
        }

        /* Synthetic Division Styles */
        .synthetic-grid {
            display: inline-block;
            margin: 20px auto;
            font-family: 'Courier New', monospace;
            font-size: 1.2em;
        }

        .synthetic-row {
            display: flex;
            justify-content: center;
        }

        .synthetic-cell {
            width: 60px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #ddd;
            background: white;
        }

        .synthetic-cell.divisor {
            background: #667eea;
            color: white;
            font-weight: bold;
            border-right: 3px solid #333;
        }

        .synthetic-cell.result {
            background: #e8f5e9;
            font-weight: bold;
            border-top: 3px solid #333;
        }

        .synthetic-cell.carry {
            background: #fff3e0;
            font-size: 0.9em;
        }

        .synthetic-cell.header {
            background: #f5f5f5;
            font-weight: bold;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        .step-dot {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8em;
            color: #666;
            transition: all 0.3s ease;
        }

        .step-dot.active {
            background: #667eea;
            color: white;
        }

        .step-dot.complete {
            background: #28a745;
            color: white;
        }

        .step-controls {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 20px 0;
        }

        table.division-table {
            border-collapse: collapse;
            margin: 20px auto;
            font-family: 'Cambria Math', 'Times New Roman', serif;
        }

        table.division-table td, table.division-table th {
            padding: 10px 15px;
            text-align: center;
        }

        table.division-table .border-bottom {
            border-bottom: 2px solid #333;
        }

        table.division-table .border-right {
            border-right: 2px solid #333;
        }

        sup {
            font-size: 0.7em;
        }

        .example-card {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
        }

        .example-title {
            color: #667eea;
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .buttons-row {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .tab-btn {
                padding: 10px 16px;
                font-size: 0.9em;
            }

            .section {
                padding: 20px;
            }

            .synthetic-cell {
                width: 45px;
                height: 35px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>4.3 Dividing Polynomials</h1>
            <p>Long Division, Synthetic Division & The Remainder Theorem</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="showSection('learn')">Learn</button>
            <button class="tab-btn" onclick="showSection('longdiv')">Long Division</button>
            <button class="tab-btn" onclick="showSection('synthetic')">Synthetic Division</button>
            <button class="tab-btn" onclick="showSection('remainder')">Remainder Theorem</button>
            <button class="tab-btn" onclick="showSection('practice')">Practice</button>
        </div>

        <!-- LEARN SECTION -->
        <div id="learn" class="section active">
            <h2>Understanding Polynomial Division</h2>

            <div class="info-box">
                <p><strong>Why divide polynomials?</strong></p>
                <p>Just like with numbers, we can divide one polynomial by another. This helps us:</p>
                <ul>
                    <li>Factor polynomials</li>
                    <li>Find zeros of polynomial functions</li>
                    <li>Simplify rational expressions</li>
                </ul>
            </div>

            <h3>Two Methods for Dividing Polynomials</h3>

            <div class="example-card">
                <div class="example-title">1. Long Division</div>
                <p>Works for dividing by <strong>any polynomial</strong>.</p>
                <p>Similar to long division with numbers - divide, multiply, subtract, bring down, repeat.</p>
                <p><strong>Use when:</strong> The divisor has degree ‚â• 2, or you want to see all the work.</p>
            </div>

            <div class="example-card">
                <div class="example-title">2. Synthetic Division</div>
                <p>A shortcut that <strong>only works when dividing by (x - k)</strong>.</p>
                <p>Uses only the coefficients - faster and less writing!</p>
                <p><strong>Use when:</strong> Dividing by a linear factor of the form (x - k) or (x + k).</p>
            </div>

            <h3>Key Vocabulary</h3>
            <div class="info-box">
                <p><strong>Dividend:</strong> The polynomial being divided (the "top")</p>
                <p><strong>Divisor:</strong> What you're dividing by (the "bottom")</p>
                <p><strong>Quotient:</strong> The result of the division</p>
                <p><strong>Remainder:</strong> What's left over</p>
                <br>
                <p style="text-align: center; font-size: 1.2em;">
                    <strong>Dividend = Divisor √ó Quotient + Remainder</strong>
                </p>
            </div>

            <h3>The Remainder Theorem</h3>
            <div class="example-card">
                <div class="example-title">Powerful Shortcut!</div>
                <p>When a polynomial f(x) is divided by (x - k), the remainder equals <strong>f(k)</strong>.</p>
                <p>This means: To find the remainder, just substitute k into the polynomial!</p>
                <br>
                <p><strong>Example:</strong> Find the remainder when f(x) = x¬≥ - 4x + 2 is divided by (x - 3).</p>
                <p>Solution: f(3) = (3)¬≥ - 4(3) + 2 = 27 - 12 + 2 = <strong>17</strong></p>
            </div>

            <div class="warning-box">
                <p><strong>Important!</strong></p>
                <p>Before dividing, always write the dividend in <strong>standard form</strong> (descending powers of x).</p>
                <p>If any powers are missing, use <strong>0 as a placeholder</strong>.</p>
                <p>Example: x¬≥ + 5 should be written as x¬≥ + 0x¬≤ + 0x + 5</p>
            </div>
        </div>

        <!-- LONG DIVISION SECTION -->
        <div id="longdiv" class="section">
            <h2>Long Division of Polynomials</h2>

            <div class="info-box">
                <p><strong>Steps for Long Division:</strong></p>
                <ol>
                    <li><strong>Divide:</strong> Divide the leading term of dividend by leading term of divisor</li>
                    <li><strong>Multiply:</strong> Multiply the divisor by what you just got</li>
                    <li><strong>Subtract:</strong> Subtract from the dividend</li>
                    <li><strong>Bring Down:</strong> Bring down the next term</li>
                    <li><strong>Repeat:</strong> Continue until the degree of remainder < degree of divisor</li>
                </ol>
            </div>

            <h3>Interactive Example</h3>
            <div class="practice-problem">
                <p><strong>Divide:</strong> (x¬≥ + 2x¬≤ - 5x - 6) √∑ (x + 3)</p>

                <div class="step-indicator" id="long-steps">
                    <div class="step-dot active">1</div>
                    <div class="step-dot">2</div>
                    <div class="step-dot">3</div>
                    <div class="step-dot">4</div>
                    <div class="step-dot">5</div>
                    <div class="step-dot">6</div>
                </div>

                <div class="long-division" id="long-div-display">
                    <!-- Will be populated by JavaScript -->
                </div>

                <div class="step-controls">
                    <button class="btn btn-secondary" onclick="longDivPrev()">‚Üê Previous</button>
                    <button class="btn btn-primary" onclick="longDivNext()">Next ‚Üí</button>
                    <button class="btn btn-hint" onclick="longDivReset()">Reset</button>
                </div>

                <div id="long-div-explanation" class="info-box"></div>
            </div>

            <h3>Try a New Problem</h3>
            <div class="practice-problem">
                <div class="division-display" id="long-new-problem"></div>

                <div class="input-group">
                    <label>Quotient:</label>
                    <input type="text" id="long-quotient" placeholder="e.g., x^2 - x + 2">
                </div>
                <div class="input-group">
                    <label>Remainder:</label>
                    <input type="text" id="long-remainder" placeholder="e.g., 5 or 0">
                </div>

                <div class="feedback" id="long-feedback"></div>

                <div class="buttons-row">
                    <button class="btn btn-hint" onclick="showLongHint()">Show Steps</button>
                    <button class="btn btn-primary" onclick="checkLongDiv()">Check Answer</button>
                    <button class="btn btn-secondary" onclick="newLongProblem()">New Problem</button>
                </div>
            </div>
        </div>

        <!-- SYNTHETIC DIVISION SECTION -->
        <div id="synthetic" class="section">
            <h2>Synthetic Division</h2>

            <div class="info-box">
                <p><strong>Synthetic Division</strong> is a shortcut for dividing by (x - k).</p>
                <p>Key insight: When dividing by (x - k), use <strong>k</strong> (the opposite sign!).</p>
                <ul>
                    <li>Dividing by (x - 3) ‚Üí use <strong>3</strong></li>
                    <li>Dividing by (x + 2) ‚Üí use <strong>-2</strong> (since x + 2 = x - (-2))</li>
                </ul>
            </div>

            <h3>Interactive Example</h3>
            <div class="practice-problem">
                <p><strong>Divide:</strong> (2x¬≥ - 5x¬≤ + 3x - 7) √∑ (x - 2)</p>

                <div class="step-indicator" id="synth-steps">
                    <div class="step-dot active">1</div>
                    <div class="step-dot">2</div>
                    <div class="step-dot">3</div>
                    <div class="step-dot">4</div>
                    <div class="step-dot">5</div>
                </div>

                <div style="text-align: center;">
                    <div class="synthetic-grid" id="synth-grid">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="step-controls">
                    <button class="btn btn-secondary" onclick="synthPrev()">‚Üê Previous</button>
                    <button class="btn btn-primary" onclick="synthNext()">Next ‚Üí</button>
                    <button class="btn btn-hint" onclick="synthReset()">Reset</button>
                </div>

                <div id="synth-explanation" class="info-box"></div>
            </div>

            <h3>Practice Synthetic Division</h3>
            <div class="practice-problem">
                <div class="division-display" id="synth-problem"></div>

                <div class="input-group">
                    <label>Quotient:</label>
                    <input type="text" id="synth-quotient" placeholder="e.g., 2x^2 + x - 1">
                </div>
                <div class="input-group">
                    <label>Remainder:</label>
                    <input type="text" id="synth-remainder" placeholder="e.g., 5">
                </div>

                <div class="feedback" id="synth-feedback"></div>

                <div class="buttons-row">
                    <button class="btn btn-hint" onclick="showSynthHint()">Show Steps</button>
                    <button class="btn btn-primary" onclick="checkSynth()">Check Answer</button>
                    <button class="btn btn-secondary" onclick="newSynthProblem()">New Problem</button>
                </div>
            </div>
        </div>

        <!-- REMAINDER THEOREM SECTION -->
        <div id="remainder" class="section">
            <h2>The Remainder Theorem</h2>

            <div class="info-box">
                <p style="font-size: 1.2em; text-align: center;">
                    <strong>If f(x) is divided by (x - k), the remainder is f(k).</strong>
                </p>
            </div>

            <div class="example-card">
                <div class="example-title">Why is this useful?</div>
                <p>Instead of doing full division to find the remainder, just <strong>plug in k</strong>!</p>
                <br>
                <p><strong>Example:</strong> Find the remainder when f(x) = 2x‚Å¥ - 3x¬≥ + x - 5 is divided by (x - 2).</p>
                <p><strong>Solution:</strong></p>
                <p style="margin-left: 20px;">
                    f(2) = 2(2)‚Å¥ - 3(2)¬≥ + (2) - 5<br>
                    f(2) = 2(16) - 3(8) + 2 - 5<br>
                    f(2) = 32 - 24 + 2 - 5<br>
                    f(2) = <strong>5</strong>
                </p>
                <p>The remainder is <strong>5</strong>.</p>
            </div>

            <h3>The Factor Theorem (Bonus!)</h3>
            <div class="example-card">
                <div class="example-title">Special Case of the Remainder Theorem</div>
                <p>If f(k) = 0, then (x - k) is a <strong>factor</strong> of f(x).</p>
                <p>This means the remainder is 0, so the division is exact!</p>
                <br>
                <p><strong>Example:</strong> Is (x - 2) a factor of f(x) = x¬≥ - 6x¬≤ + 11x - 6?</p>
                <p><strong>Check:</strong> f(2) = (2)¬≥ - 6(2)¬≤ + 11(2) - 6 = 8 - 24 + 22 - 6 = <strong>0</strong></p>
                <p>Yes! Since f(2) = 0, (x - 2) IS a factor of f(x).</p>
            </div>

            <h3>Practice</h3>
            <div class="score-display">
                Score: <span id="rem-score">0</span> / <span id="rem-total">0</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="rem-progress" style="width: 0%"></div>
                </div>
            </div>

            <div class="practice-problem">
                <p id="rem-question"></p>
                <div class="division-display" id="rem-function"></div>

                <div class="input-group">
                    <label>Remainder:</label>
                    <input type="number" id="rem-answer" placeholder="Enter the remainder">
                </div>

                <div class="feedback" id="rem-feedback"></div>

                <div class="buttons-row">
                    <button class="btn btn-hint" onclick="showRemHint()">Show Calculation</button>
                    <button class="btn btn-primary" onclick="checkRemainder()">Check Answer</button>
                    <button class="btn btn-secondary" onclick="newRemProblem()">New Problem</button>
                </div>
            </div>
        </div>

        <!-- PRACTICE SECTION -->
        <div id="practice" class="section">
            <h2>Mixed Practice</h2>
            <p>Test your skills with all types of polynomial division!</p>

            <div class="score-display">
                Score: <span id="prac-score">0</span> / <span id="prac-total">0</span>
                <div class="progress-bar">
                    <div class="progress-fill" id="prac-progress" style="width: 0%"></div>
                </div>
            </div>

            <div class="practice-problem">
                <p id="prac-type" style="color: #667eea; font-weight: bold;"></p>
                <div class="division-display" id="prac-problem"></div>

                <div id="prac-inputs">
                    <!-- Will be populated based on question type -->
                </div>

                <div class="feedback" id="prac-feedback"></div>

                <div class="buttons-row">
                    <button class="btn btn-hint" onclick="showPracHint()">Hint</button>
                    <button class="btn btn-primary" onclick="checkPractice()">Check Answer</button>
                    <button class="btn btn-secondary" onclick="newPracProblem()">Next Problem</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ========== TAB NAVIGATION ==========
        function showSection(sectionId) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            event.target.classList.add('active');

            // Initialize sections when shown
            if (sectionId === 'longdiv') {
                longDivReset();
                if (!document.getElementById('long-new-problem').innerHTML) newLongProblem();
            }
            if (sectionId === 'synthetic') {
                synthReset();
                if (!document.getElementById('synth-problem').innerHTML) newSynthProblem();
            }
            if (sectionId === 'remainder') {
                if (!document.getElementById('rem-function').innerHTML) newRemProblem();
            }
            if (sectionId === 'practice') {
                if (!document.getElementById('prac-problem').innerHTML) newPracProblem();
            }
        }

        // ========== LONG DIVISION INTERACTIVE ==========
        let longStep = 0;
        const longSteps = [
            {
                display: `<pre>
           ________
  x + 3 ) x¬≥ + 2x¬≤ - 5x - 6
</pre>`,
                explanation: "<strong>Step 1: Set up</strong><br>Write the dividend inside and divisor outside. Make sure dividend is in standard form!"
            },
            {
                display: `<pre>
           x¬≤
           ________
  x + 3 ) x¬≥ + 2x¬≤ - 5x - 6
</pre>`,
                explanation: "<strong>Step 2: Divide</strong><br>Divide leading terms: x¬≥ √∑ x = x¬≤. Write this above."
            },
            {
                display: `<pre>
           x¬≤
           ________
  x + 3 ) x¬≥ + 2x¬≤ - 5x - 6
          x¬≥ + 3x¬≤
</pre>`,
                explanation: "<strong>Step 3: Multiply</strong><br>Multiply (x + 3) by x¬≤: x¬≤ √ó (x + 3) = x¬≥ + 3x¬≤"
            },
            {
                display: `<pre>
           x¬≤
           ________
  x + 3 ) x¬≥ + 2x¬≤ - 5x - 6
          x¬≥ + 3x¬≤
          --------
              -x¬≤ - 5x
</pre>`,
                explanation: "<strong>Step 4: Subtract & Bring Down</strong><br>(x¬≥ + 2x¬≤) - (x¬≥ + 3x¬≤) = -x¬≤. Bring down -5x."
            },
            {
                display: `<pre>
           x¬≤  - x
           ________
  x + 3 ) x¬≥ + 2x¬≤ - 5x - 6
          x¬≥ + 3x¬≤
          --------
              -x¬≤ - 5x
              -x¬≤ - 3x
              --------
                  -2x - 6
</pre>`,
                explanation: "<strong>Step 5: Repeat</strong><br>Divide: -x¬≤ √∑ x = -x. Multiply: -x(x + 3) = -x¬≤ - 3x. Subtract & bring down."
            },
            {
                display: `<pre>
           x¬≤  - x  - 2
           ____________
  x + 3 ) x¬≥ + 2x¬≤ - 5x - 6
          x¬≥ + 3x¬≤
          --------
              -x¬≤ - 5x
              -x¬≤ - 3x
              --------
                  -2x - 6
                  -2x - 6
                  -------
                       0
</pre>`,
                explanation: "<strong>Step 6: Complete</strong><br>Divide: -2x √∑ x = -2. Multiply: -2(x + 3) = -2x - 6. Subtract: 0!<br><br><strong>Answer: x¬≤ - x - 2 with remainder 0</strong><br>This means (x + 3) is a factor!"
            }
        ];

        function longDivReset() {
            longStep = 0;
            updateLongDiv();
        }

        function longDivNext() {
            if (longStep < longSteps.length - 1) {
                longStep++;
                updateLongDiv();
            }
        }

        function longDivPrev() {
            if (longStep > 0) {
                longStep--;
                updateLongDiv();
            }
        }

        function updateLongDiv() {
            document.getElementById('long-div-display').innerHTML = longSteps[longStep].display;
            document.getElementById('long-div-explanation').innerHTML = longSteps[longStep].explanation;

            document.querySelectorAll('#long-steps .step-dot').forEach((dot, i) => {
                dot.classList.remove('active', 'complete');
                if (i < longStep) dot.classList.add('complete');
                if (i === longStep) dot.classList.add('active');
            });
        }

        // Long Division Practice Problems
        const longProblems = [
            { dividend: [1, 5, 6], divisor: [1, 2], quotient: "x + 3", remainder: "0", hint: "x¬≤ + 5x + 6 = (x + 2)(x + 3)" },
            { dividend: [1, -1, -6], divisor: [1, -3], quotient: "x + 2", remainder: "0", hint: "Try: x¬≤ √∑ x = x, then multiply and subtract" },
            { dividend: [2, 1, -5, 2], divisor: [1, 2], quotient: "2x^2 - 3x + 1", remainder: "0", hint: "2x¬≥ √∑ x = 2x¬≤" },
            { dividend: [1, 0, -4, 0, 3], divisor: [1, -1], quotient: "x^3 + x^2 - 3x - 3", remainder: "0", hint: "Don't forget the 0 placeholders!" },
            { dividend: [1, 2, -3, 5], divisor: [1, 1], quotient: "x^2 + x - 4", remainder: "9", hint: "When remainder ‚â† 0, it goes after the quotient" }
        ];

        let currentLongProblem = null;

        function newLongProblem() {
            currentLongProblem = longProblems[Math.floor(Math.random() * longProblems.length)];
            const dividendStr = formatPoly(currentLongProblem.dividend);
            const divisorStr = formatPoly(currentLongProblem.divisor);
            document.getElementById('long-new-problem').innerHTML = `(${dividendStr}) √∑ (${divisorStr})`;
            document.getElementById('long-quotient').value = '';
            document.getElementById('long-remainder').value = '';
            document.getElementById('long-quotient').className = '';
            document.getElementById('long-remainder').className = '';
            document.getElementById('long-feedback').className = 'feedback';
        }

        function checkLongDiv() {
            const qInput = document.getElementById('long-quotient');
            const rInput = document.getElementById('long-remainder');
            const feedback = document.getElementById('long-feedback');

            const userQ = normalizeAnswer(qInput.value);
            const userR = normalizeAnswer(rInput.value);
            const correctQ = normalizeAnswer(currentLongProblem.quotient);
            const correctR = normalizeAnswer(currentLongProblem.remainder);

            const qCorrect = userQ === correctQ;
            const rCorrect = userR === correctR;

            qInput.className = qCorrect ? 'correct' : 'incorrect';
            rInput.className = rCorrect ? 'correct' : 'incorrect';

            if (qCorrect && rCorrect) {
                feedback.className = 'feedback correct show';
                feedback.innerHTML = '<strong>Correct!</strong> Great work with long division!';
            } else {
                feedback.className = 'feedback incorrect show';
                feedback.innerHTML = `<strong>Not quite.</strong><br>Quotient: ${currentLongProblem.quotient}<br>Remainder: ${currentLongProblem.remainder}`;
            }
        }

        function showLongHint() {
            const feedback = document.getElementById('long-feedback');
            feedback.className = 'feedback hint show';
            feedback.innerHTML = `üí° <strong>Hint:</strong> ${currentLongProblem.hint}`;
        }

        // ========== SYNTHETIC DIVISION INTERACTIVE ==========
        let synthStep = 0;
        // Dividing 2x¬≥ - 5x¬≤ + 3x - 7 by (x - 2)
        const synthSteps = [
            {
                grid: [
                    ['divisor', '2'],
                    ['header', '2', '-5', '3', '-7'],
                    ['carry', '', '', '', ''],
                    ['result', '', '', '', '']
                ],
                explanation: "<strong>Step 1: Set up</strong><br>Write the divisor (k = 2) on the left. Write coefficients across the top: 2, -5, 3, -7"
            },
            {
                grid: [
                    ['divisor', '2'],
                    ['header', '2', '-5', '3', '-7'],
                    ['carry', '', '', '', ''],
                    ['result', '2', '', '', '']
                ],
                explanation: "<strong>Step 2: Bring down</strong><br>Bring down the first coefficient (2) to the result row."
            },
            {
                grid: [
                    ['divisor', '2'],
                    ['header', '2', '-5', '3', '-7'],
                    ['carry', '', '4', '', ''],
                    ['result', '2', '-1', '', '']
                ],
                explanation: "<strong>Step 3: Multiply & Add</strong><br>Multiply: 2 √ó 2 = 4 (write in carry row)<br>Add: -5 + 4 = -1 (write in result)"
            },
            {
                grid: [
                    ['divisor', '2'],
                    ['header', '2', '-5', '3', '-7'],
                    ['carry', '', '4', '-2', ''],
                    ['result', '2', '-1', '1', '']
                ],
                explanation: "<strong>Step 4: Repeat</strong><br>Multiply: 2 √ó (-1) = -2<br>Add: 3 + (-2) = 1"
            },
            {
                grid: [
                    ['divisor', '2'],
                    ['header', '2', '-5', '3', '-7'],
                    ['carry', '', '4', '-2', '2'],
                    ['result', '2', '-1', '1', '-5']
                ],
                explanation: "<strong>Step 5: Final step</strong><br>Multiply: 2 √ó 1 = 2<br>Add: -7 + 2 = -5<br><br><strong>Result:</strong> Quotient = 2x¬≤ - x + 1, Remainder = -5"
            }
        ];

        function synthReset() {
            synthStep = 0;
            updateSynth();
        }

        function synthNext() {
            if (synthStep < synthSteps.length - 1) {
                synthStep++;
                updateSynth();
            }
        }

        function synthPrev() {
            if (synthStep > 0) {
                synthStep--;
                updateSynth();
            }
        }

        function updateSynth() {
            const grid = synthSteps[synthStep].grid;
            let html = '';

            for (let row = 1; row < grid.length; row++) {
                html += '<div class="synthetic-row">';
                if (row === 1) {
                    html += `<div class="synthetic-cell divisor">${grid[0][1]}</div>`;
                } else {
                    html += `<div class="synthetic-cell" style="border: none; background: transparent;"></div>`;
                }
                for (let col = 1; col < grid[row].length; col++) {
                    let cellClass = 'synthetic-cell';
                    if (grid[row][0] === 'header') cellClass += ' header';
                    if (grid[row][0] === 'carry') cellClass += ' carry';
                    if (grid[row][0] === 'result') cellClass += ' result';
                    html += `<div class="${cellClass}">${grid[row][col]}</div>`;
                }
                html += '</div>';
            }

            document.getElementById('synth-grid').innerHTML = html;
            document.getElementById('synth-explanation').innerHTML = synthSteps[synthStep].explanation;

            document.querySelectorAll('#synth-steps .step-dot').forEach((dot, i) => {
                dot.classList.remove('active', 'complete');
                if (i < synthStep) dot.classList.add('complete');
                if (i === synthStep) dot.classList.add('active');
            });
        }

        // Synthetic Division Practice
        const synthProblems = [
            { dividend: [1, -4, 3], k: 3, quotient: "x - 1", remainder: "0", hint: "k = 3. Coefficients: 1, -4, 3" },
            { dividend: [1, 2, -5, -6], k: 2, quotient: "x^2 + 4x + 3", remainder: "0", hint: "k = 2. Bring down, multiply by 2, add." },
            { dividend: [2, -3, 0, 5], k: -1, quotient: "2x^2 - 5x + 5", remainder: "0", hint: "k = -1 (dividing by x + 1). Note the 0 coefficient!" },
            { dividend: [1, 0, -4, 0, 1], k: 1, quotient: "x^3 + x^2 - 3x - 3", remainder: "-2", hint: "k = 1. Use placeholders for missing terms." },
            { dividend: [3, -2, 5, -1], k: 2, quotient: "3x^2 + 4x + 13", remainder: "25", hint: "k = 2. Work through: 3, then 3√ó2-2=4, etc." }
        ];

        let currentSynthProblem = null;

        function newSynthProblem() {
            currentSynthProblem = synthProblems[Math.floor(Math.random() * synthProblems.length)];
            const dividendStr = formatPoly(currentSynthProblem.dividend);
            const divisorStr = currentSynthProblem.k >= 0 ? `x - ${currentSynthProblem.k}` : `x + ${-currentSynthProblem.k}`;
            document.getElementById('synth-problem').innerHTML = `(${dividendStr}) √∑ (${divisorStr})`;
            document.getElementById('synth-quotient').value = '';
            document.getElementById('synth-remainder').value = '';
            document.getElementById('synth-quotient').className = '';
            document.getElementById('synth-remainder').className = '';
            document.getElementById('synth-feedback').className = 'feedback';
        }

        function checkSynth() {
            const qInput = document.getElementById('synth-quotient');
            const rInput = document.getElementById('synth-remainder');
            const feedback = document.getElementById('synth-feedback');

            const userQ = normalizeAnswer(qInput.value);
            const userR = normalizeAnswer(rInput.value);
            const correctQ = normalizeAnswer(currentSynthProblem.quotient);
            const correctR = normalizeAnswer(currentSynthProblem.remainder);

            const qCorrect = userQ === correctQ;
            const rCorrect = userR === correctR;

            qInput.className = qCorrect ? 'correct' : 'incorrect';
            rInput.className = rCorrect ? 'correct' : 'incorrect';

            if (qCorrect && rCorrect) {
                feedback.className = 'feedback correct show';
                feedback.innerHTML = '<strong>Correct!</strong> Synthetic division mastered!';
            } else {
                feedback.className = 'feedback incorrect show';
                feedback.innerHTML = `<strong>Not quite.</strong><br>Quotient: ${currentSynthProblem.quotient}<br>Remainder: ${currentSynthProblem.remainder}`;
            }
        }

        function showSynthHint() {
            const feedback = document.getElementById('synth-feedback');
            feedback.className = 'feedback hint show';
            feedback.innerHTML = `üí° <strong>Hint:</strong> ${currentSynthProblem.hint}`;
        }

        // ========== REMAINDER THEOREM ==========
        const remProblems = [
            { coeffs: [1, -3, 2, 5], k: 2, hint: "f(2) = (2)¬≥ - 3(2)¬≤ + 2(2) + 5" },
            { coeffs: [2, 0, -5, 1], k: 3, hint: "f(3) = 2(3)¬≥ + 0(3)¬≤ - 5(3) + 1 = 2(27) - 15 + 1" },
            { coeffs: [1, -4, 1, 6], k: -1, hint: "f(-1) = (-1)¬≥ - 4(-1)¬≤ + (-1) + 6" },
            { coeffs: [1, 2, -3, -4, 5], k: 1, hint: "f(1) = 1 + 2 - 3 - 4 + 5" },
            { coeffs: [3, -1, 0, 2], k: -2, hint: "f(-2) = 3(-2)¬≥ - (-2)¬≤ + 0(-2) + 2" }
        ];

        let currentRemProblem = null;
        let remScore = 0;
        let remTotal = 0;

        function newRemProblem() {
            currentRemProblem = remProblems[Math.floor(Math.random() * remProblems.length)];
            const funcStr = formatPoly(currentRemProblem.coeffs);
            const kStr = currentRemProblem.k >= 0 ? `x - ${currentRemProblem.k}` : `x + ${-currentRemProblem.k}`;

            document.getElementById('rem-question').innerHTML = `Find the remainder when f(x) is divided by (${kStr}):`;
            document.getElementById('rem-function').innerHTML = `f(x) = ${funcStr}`;
            document.getElementById('rem-answer').value = '';
            document.getElementById('rem-answer').className = '';
            document.getElementById('rem-feedback').className = 'feedback';
        }

        function checkRemainder() {
            const input = document.getElementById('rem-answer');
            const feedback = document.getElementById('rem-feedback');

            const userAnswer = parseInt(input.value);
            const correctAnswer = evaluatePoly(currentRemProblem.coeffs, currentRemProblem.k);

            remTotal++;

            if (userAnswer === correctAnswer) {
                remScore++;
                input.className = 'correct';
                feedback.className = 'feedback correct show';
                feedback.innerHTML = `<strong>Correct!</strong> f(${currentRemProblem.k}) = ${correctAnswer}`;
            } else {
                input.className = 'incorrect';
                feedback.className = 'feedback incorrect show';
                feedback.innerHTML = `<strong>Not quite.</strong> f(${currentRemProblem.k}) = ${correctAnswer}`;
            }

            updateRemScore();
        }

        function showRemHint() {
            const feedback = document.getElementById('rem-feedback');
            feedback.className = 'feedback hint show';
            feedback.innerHTML = `üí° <strong>Calculate:</strong> ${currentRemProblem.hint}`;
        }

        function updateRemScore() {
            document.getElementById('rem-score').textContent = remScore;
            document.getElementById('rem-total').textContent = remTotal;
            const pct = remTotal > 0 ? (remScore / remTotal * 100) : 0;
            document.getElementById('rem-progress').style.width = pct + '%';
        }

        // ========== MIXED PRACTICE ==========
        const pracProblems = [
            { type: 'long', dividend: [1, 3, -10], divisor: [1, -2], quotient: "x + 5", remainder: "0", hint: "Use long division: x¬≤ √∑ x = x" },
            { type: 'synth', dividend: [1, -6, 11, -6], k: 1, quotient: "x^2 - 5x + 6", remainder: "0", hint: "Synthetic with k = 1" },
            { type: 'remainder', coeffs: [2, -1, 3, -4], k: 2, hint: "Just evaluate f(2)" },
            { type: 'factor', coeffs: [1, -2, -5, 6], k: 3, hint: "If f(3) = 0, then (x - 3) is a factor" },
            { type: 'synth', dividend: [2, 0, -3, 1], k: -1, quotient: "2x^2 - 2x - 1", remainder: "2", hint: "Don't forget the 0 coefficient for x¬≤" },
            { type: 'long', dividend: [1, 1, -5, -2, 4], divisor: [1, 2], quotient: "x^3 - x^2 - 3x + 4", remainder: "-4", hint: "Long division with degree 4 polynomial" }
        ];

        let currentPracProblem = null;
        let pracScore = 0;
        let pracTotal = 0;

        function newPracProblem() {
            currentPracProblem = pracProblems[Math.floor(Math.random() * pracProblems.length)];
            const inputs = document.getElementById('prac-inputs');
            const typeEl = document.getElementById('prac-type');
            const problem = document.getElementById('prac-problem');

            if (currentPracProblem.type === 'long') {
                typeEl.textContent = 'Long Division';
                const dividendStr = formatPoly(currentPracProblem.dividend);
                const divisorStr = formatPoly(currentPracProblem.divisor);
                problem.innerHTML = `(${dividendStr}) √∑ (${divisorStr})`;
                inputs.innerHTML = `
                    <div class="input-group">
                        <label>Quotient:</label>
                        <input type="text" id="prac-q" placeholder="e.g., x^2 + 3x - 1">
                    </div>
                    <div class="input-group">
                        <label>Remainder:</label>
                        <input type="text" id="prac-r" placeholder="e.g., 5">
                    </div>
                `;
            } else if (currentPracProblem.type === 'synth') {
                typeEl.textContent = 'Synthetic Division';
                const dividendStr = formatPoly(currentPracProblem.dividend);
                const divisorStr = currentPracProblem.k >= 0 ? `x - ${currentPracProblem.k}` : `x + ${-currentPracProblem.k}`;
                problem.innerHTML = `(${dividendStr}) √∑ (${divisorStr})`;
                inputs.innerHTML = `
                    <div class="input-group">
                        <label>Quotient:</label>
                        <input type="text" id="prac-q" placeholder="e.g., 2x^2 - x + 3">
                    </div>
                    <div class="input-group">
                        <label>Remainder:</label>
                        <input type="text" id="prac-r" placeholder="e.g., 5">
                    </div>
                `;
            } else if (currentPracProblem.type === 'remainder') {
                typeEl.textContent = 'Remainder Theorem';
                const funcStr = formatPoly(currentPracProblem.coeffs);
                const divisorStr = currentPracProblem.k >= 0 ? `x - ${currentPracProblem.k}` : `x + ${-currentPracProblem.k}`;
                problem.innerHTML = `f(x) = ${funcStr}<br><br>Find the remainder when divided by (${divisorStr})`;
                inputs.innerHTML = `
                    <div class="input-group">
                        <label>Remainder:</label>
                        <input type="number" id="prac-r" placeholder="Enter remainder">
                    </div>
                `;
            } else if (currentPracProblem.type === 'factor') {
                typeEl.textContent = 'Factor Theorem';
                const funcStr = formatPoly(currentPracProblem.coeffs);
                const divisorStr = currentPracProblem.k >= 0 ? `x - ${currentPracProblem.k}` : `x + ${-currentPracProblem.k}`;
                problem.innerHTML = `f(x) = ${funcStr}<br><br>Is (${divisorStr}) a factor of f(x)?`;
                inputs.innerHTML = `
                    <div class="input-group" style="justify-content: center;">
                        <button class="btn btn-secondary" id="prac-yes" onclick="selectFactorAnswer(true)">Yes, it's a factor</button>
                        <button class="btn btn-secondary" id="prac-no" onclick="selectFactorAnswer(false)">No, it's not a factor</button>
                    </div>
                    <input type="hidden" id="prac-factor-answer" value="">
                `;
            }

            document.getElementById('prac-feedback').className = 'feedback';
        }

        function selectFactorAnswer(isFactor) {
            document.getElementById('prac-factor-answer').value = isFactor ? 'yes' : 'no';
            document.getElementById('prac-yes').style.background = isFactor ? '#667eea' : '#6c757d';
            document.getElementById('prac-no').style.background = isFactor ? '#6c757d' : '#667eea';
        }

        function checkPractice() {
            const feedback = document.getElementById('prac-feedback');
            let correct = false;
            let explanation = '';

            pracTotal++;

            if (currentPracProblem.type === 'long' || currentPracProblem.type === 'synth') {
                const qInput = document.getElementById('prac-q');
                const rInput = document.getElementById('prac-r');
                const userQ = normalizeAnswer(qInput.value);
                const userR = normalizeAnswer(rInput.value);
                const correctQ = normalizeAnswer(currentPracProblem.quotient);
                const correctR = normalizeAnswer(currentPracProblem.remainder);

                correct = (userQ === correctQ && userR === correctR);
                qInput.className = userQ === correctQ ? 'correct' : 'incorrect';
                rInput.className = userR === correctR ? 'correct' : 'incorrect';
                explanation = `Quotient: ${currentPracProblem.quotient}, Remainder: ${currentPracProblem.remainder}`;
            } else if (currentPracProblem.type === 'remainder') {
                const rInput = document.getElementById('prac-r');
                const userR = parseInt(rInput.value);
                const correctR = evaluatePoly(currentPracProblem.coeffs, currentPracProblem.k);

                correct = (userR === correctR);
                rInput.className = correct ? 'correct' : 'incorrect';
                explanation = `f(${currentPracProblem.k}) = ${correctR}`;
            } else if (currentPracProblem.type === 'factor') {
                const userAnswer = document.getElementById('prac-factor-answer').value;
                const remainder = evaluatePoly(currentPracProblem.coeffs, currentPracProblem.k);
                const isFactor = remainder === 0;

                correct = (userAnswer === 'yes' && isFactor) || (userAnswer === 'no' && !isFactor);
                explanation = `f(${currentPracProblem.k}) = ${remainder}. ${isFactor ? 'Since remainder = 0, it IS a factor.' : 'Since remainder ‚â† 0, it is NOT a factor.'}`;
            }

            if (correct) {
                pracScore++;
                feedback.className = 'feedback correct show';
                feedback.innerHTML = `<strong>Correct!</strong> ${explanation}`;
            } else {
                feedback.className = 'feedback incorrect show';
                feedback.innerHTML = `<strong>Not quite.</strong> ${explanation}`;
            }

            updatePracScore();
        }

        function showPracHint() {
            const feedback = document.getElementById('prac-feedback');
            feedback.className = 'feedback hint show';
            feedback.innerHTML = `üí° <strong>Hint:</strong> ${currentPracProblem.hint}`;
        }

        function updatePracScore() {
            document.getElementById('prac-score').textContent = pracScore;
            document.getElementById('prac-total').textContent = pracTotal;
            const pct = pracTotal > 0 ? (pracScore / pracTotal * 100) : 0;
            document.getElementById('prac-progress').style.width = pct + '%';
        }

        // ========== UTILITY FUNCTIONS ==========
        function formatPoly(coeffs) {
            const degree = coeffs.length - 1;
            let terms = [];

            coeffs.forEach((c, i) => {
                const power = degree - i;
                if (c === 0) return;

                let term = '';
                const absC = Math.abs(c);
                const sign = c < 0 ? ' - ' : (terms.length > 0 ? ' + ' : '');

                if (power === 0) {
                    term = absC.toString();
                } else if (power === 1) {
                    term = (absC === 1 ? '' : absC) + 'x';
                } else {
                    term = (absC === 1 ? '' : absC) + 'x<sup>' + power + '</sup>';
                }

                terms.push(sign + term);
            });

            return terms.length > 0 ? terms.join('') : '0';
        }

        function evaluatePoly(coeffs, x) {
            let result = 0;
            const degree = coeffs.length - 1;
            coeffs.forEach((c, i) => {
                result += c * Math.pow(x, degree - i);
            });
            return result;
        }

        function normalizeAnswer(str) {
            return str.toLowerCase()
                .replace(/\s+/g, '')
                .replace(/\*\*/g, '^')
                .replace(/‚àí/g, '-')
                .replace(/\+-/g, '-')
                .replace(/-\+/g, '-')
                .replace(/\^1(?![0-9])/g, '')
                .replace(/1x/g, 'x')
                .replace(/x\^0/g, '1');
        }

        // Add enter key support
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                const active = document.querySelector('.section.active');
                if (active.id === 'longdiv' && document.getElementById('long-quotient').value) {
                    checkLongDiv();
                } else if (active.id === 'synthetic' && document.getElementById('synth-quotient').value) {
                    checkSynth();
                } else if (active.id === 'remainder' && document.getElementById('rem-answer').value) {
                    checkRemainder();
                } else if (active.id === 'practice') {
                    checkPractice();
                }
            }
        });
    </script>
</body>
</html>
